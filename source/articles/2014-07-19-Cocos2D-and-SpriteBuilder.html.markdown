---
title: Cocos2D and SpriteBuilder
date: 2014-07-19 07:19 UTC
tags:
---

> [原文] [coco]

Cocos2D 3 提供带来了一个全新的布局系统并且提供了很多定位方式。新系统帮助我们为不同的屏幕尺寸定义布局而且提供多屏幕支持。

这篇教程将带你浏览不同的选择然后给你关于新系统的例子。下面是这篇教程的结构：

__第一部分:__

- 介绍新的布局系统
- 屏幕模式
- 不同屏幕尺寸下的Sprite
- 不同布局挑战的例子

__第二部分:__

- 让你的游戏可以运行在手机和平板上的不同方法

# Cocos2D中的布局选择

首先让我们来了解一下不同的布局选择，然后我们在例子中使用他们。下面是控制布局的不同参数:

- __锚点(Anchor point):__ Node中的一个点，用来代表该Node在定位中的引用。
- __参考角落(Reference corner):__ 指定父节点使用哪个角落来当做参考点，默认是父节点的左下角。例如一个Node的位置是(0,0),那么它将被放置在左下角。
- __定位类型(Position type):__ 可以单独选择是用在垂直定位还是水平定位。下面是三种选择：
    - __点(Points):__ 默认单位。点可以通过`UIScaleFactor`来度量，如果你是在搭建一个平板的版本，点将通过这个工厂来进行转换，默认的平板`UIScaleFactor`是2.0,意味着你平板上显示的位置都将是两倍的距离。
    - __UI 点(UI Points):__ 使用UI 点的定位位置将永远不会经过变换，意味着手机上和平板上的10pt是一样的大小。如果使用这个类型，那么你平板上的可视区域将大于手机上的。
    - __正常 (Normalized):__ 位置是相对于父节点的尺寸来表达的，你可以选择1.0和0.0之间的数。这很方便用来居中元素。
- __尺寸类型(Size type):__ 可以单独选择宽或者高。这里一共有五种不同的选择：
    - __点(Points):__ 又一次点，这是默认的单位，可以通过`UIScaleFactor`来进行转换。
    - __UI 点(UI Points):__ 大小通过绝对的点提供，大小在不同的设备上保持一致。
    - __正常 (Normalized):__ 大小相对于父节点的大小表达，可以选择1.0和0.0之间的数值。
    - __插入点(Inset Points):__ 该节点的大小将由父节点的大小减去你定义的插入点的大小来决定。插入点的大小会由设备尺寸进行相应变换。你将会在本教程中看到实际的例子。
    - __插入UI点(Inset UI Points):__ 和插入点一样但是不根据设备改变。

这确实是一个相当大的列表！这些概念都将随着我们的例子变得更加理解。下面我们看一下屏幕的模式(Screen Modes),另一种由SpriteBuilder提供的特性。

# 屏幕模式

SpriteBuilder有两种屏幕模式：

- 活动
- 固定

屏幕模式决定了你运行在不同屏幕上的场景如何变换。当你选择活动模式，场景将会调整大小来适应当前屏幕的大小。因此当你定义一个节点的大小或者尺寸是父节点的百分之多少的时候，它们将会在不同的屏幕上改变，依据屏幕的大小或者设备。

当你选择固定屏幕模式，你的场景将会在不同的设备上保持一致的大小。

这里我们用图示来表示这两种改变，图中黄色色块的尺寸大小(长和宽)定义为父元素的20%。

![Flexible VS Fixed Screen Mode](https://static.makegameswith.us/gamernews_images/4O4sE7VW44/ScreenModes.png)

图片左边使用的是活动模式，黄色色块的宽度随着不同设备改变。在更宽的屏幕上，色块也将会显得更宽。

图片右边使用的是固定模式，色块的大小将会在任何屏幕上保持一致。

## 在SpriteBuilder中的表示

这两种模式在SpriteBuilder中有两种不同的表示方法。__活动模式__允许你在不同设备(3.5寸iPhone, 4寸iPhone，平板)之间切换来活的不同尺寸的预览，可以看到在不同尺寸的屏幕中位置和大小是如何改变的。__固定模式__只给你一种表现，高亮的_安全_和_不安全_区域会显示在屏幕上。

![safe and unsafe area](https://static.makegameswith.us/gamernews_images/TufaBarXXD/safeunsafe.png)

## 安全区和不安全区

_安全区_在不同的设备上都可以展现。_不安全区_只在一些设备上展示。例如在iPhone5上，不安全区的左右边缘都可以被看到因为屏幕变长了。在iPad上，不安全区的顶部、底部也将被看见因为屏幕的比例比手机的高。

我们将在后面讨论如何使用固定模式，然而基本的概念是保持所有相关的内容在安全区，在不安全区填充或覆盖更大的背景图像。

# 精灵和不同的设备类型

现在我们了解了不同的选择在不同的设备上是如何变幻节点的位置和大小的。如果你想控制精灵是否放大你应当对SpriteBuilder的资源管理有详细的了解。

当你使用SpriteBuilder，默认是提供 4x 的图像来供游戏使用。通过4x大小的图像，SpriteBuilder可以得到所有更小的图像尺寸。假设你有一张50x50点的图像在iPhone的屏幕上，那么4x图像的分辨率就是 200x200。

下表中展示了在不通不过设备中默认的图像尺寸

设备  | 默认图片类型 | 屏幕上的尺寸 (点)  | 分辨率
--- | --- | --- | ---
iPhone   | 1x | 50 x 50 | 50 x 50
iPhone Retina | 2x  |  50 x 50  | 100 x 100
iPad     |2x     |100 x 100  |100 x 100
iPad retina | 4x    | 100 x 100 | 200 x 200

这意味着iPad上默认的精灵在iPhone上会显示为两倍大。基本假设是平板电脑相对于手机至少有两倍的屏幕空间，所以平板中游戏双倍的图像大小将代表手机上同样的大小。

你可以看到一张图片的默认设置中显示了上面表格的内容。

![image default setting](https://static.makegameswith.us/gamernews_images/Ag6GXUTFMT/Screen%20Shot%202014-02-19%20at%2015.39.15.png)



[coco]: https://www.makegameswith.us/gamernews/361/dynamic-layouts-with-spritebuilder-and-cocos2d-3x
